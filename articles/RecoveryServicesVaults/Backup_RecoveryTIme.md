---
title: Azure Backup の バックアップ / リストア 所要時間について
date: 2022-06-25 12:00:00
tags:
  - Recovery Services vaults
  - how to
disableDisclaimer: false
---

<!-- more -->
皆様こんにちは。Azure Backup サポートの山本です。
今回はお問い合わせをいただくことが多い、Azure Backup におけるバックアップやリストアにかかる時間についてご説明いたします。 Azure VM Backup に限らず、 各 Azure Backup サービスにおける各所要時間を見積もることはかないません。

## 目次
-----------------------------------------------------------
[1. 転送データ量とバックアップやリストアにかかる時間](#1)
   [  1.2 バックアップ タイムの実績値グラフ](#1-2)
   [  1.3 リストア タイムの実績値グラフ](#1-3) 
[2. データディスクの数とバックアップやリストアにかかる時間](#2)
   [  2.1 リストア検証](#2-1) 
-----------------------------------------------------------


## <a id="1"></a> 1. 転送データ量とバックアップやリストアにかかる時間
よくお客様より、**時間の目安を見積もりたい、100GB だとどれくらいの時間がかかるか？**といったようなお問い合わせをいただくことがございます。

こちら結論から申し上げますと、**Azure VM Backup におけるバックアップやリストアの時間を見積もることは出来ません。**
Azure サービスはマルチテナント サービスであるため、 Azure Backup サービスにおける所要時間はバックアップ / リストア対象のバックアップ アイテム (VM) の転送データサイズのみではなく、他のリソース、他のユーザー様の稼働状況、帯域の状況などにも処理時間は左右されるためです。

よって、同じリソースの条件においても、そのときどきによってリストアやバックアップにかかる時間は変化する場合がございます。
そのため、リストアやバックアップにかかる時間については弊社として指標を出しておりません。

### <a id="1-1"></a> 1.1 Azure VM Backup のバックアップ時間について
特に、Azure VM Backup のバックアップ時間に関しましては、増分データが 200GB 以下である場合、24時間 以内に完了する仕様となっており、24 時間以内の完了であれば仕様の範疇でございます。


・バックアップ パフォーマンス
https://docs.microsoft.com/ja-jp/azure/backup/backup-azure-vms-introduction#backup-performance

・バックアップ プロセス
https://docs.microsoft.com/ja-jp/azure/backup/backup-azure-vms-introduction#backup-process
>抜粋："スナップショット データはコンテナーにすぐにコピーされない場合があります。 ピーク時には、数時間かかる場合があります。 毎日のバックアップ ポリシーでは、**VM のバックアップの合計時間は 24 時間未満になります。**"

また、Azure VM Backupでは Take Snapshot と Transfer data to vault の2 つのフェーズがありますが、Take Snapshot にかかった時間を確認する方法については下記をご覧ください。

・Azure VM Backup における Take Snapshot フェーズの確認方法
https://jpabrs-scem.github.io/blog/AzureVMBackup/How_to_check_VM_backup_Subtask/

次に実際の Azure VM Backup の実際のデータより作成したグラフをご参考までにお伝えさせていただきます。
### <a id="1-2"></a> 1.2 Azure VM Backup におけるバックアップ タイムの実績値グラフ
Azure VM Backup のバックアップにかかった時間と転送データ量の実績値をグラフにしたものになります。
![](https://user-images.githubusercontent.com/71251920/175569827-32081c88-3b8a-4eca-abdc-471033b3d4b8.png)

 Azure VM のバックアップにおいて **転送データ量とかかった時間に相関がない**ことがわかるかと存じます。

また、転送データ量が数TBなど (200GB より多い) 場合、24 時間以上かかる事例がございますが、上述の通り、データ量から時間を概算することはかないません。

### <a id="1-3"></a> 1.3 Azure VM Backup におけるリストア タイムの実績値グラフ
こちら、**インスタント リストア**ではなく Recovery Services コンテナー (標準コンテナー / Vault-Standard) からのリストアでございます。
Azure VM Backup のリストアにかかった時間と転送データ量の実績値をグラフにしたものになります。
![](https://user-images.githubusercontent.com/71251920/175569833-99834c3c-46f3-4901-8014-5c0a6dc0cb22.png)
リストアにおいても**転送データ量とかかった時間に相関がない**ことがわかるかと存じます。


#### インスタント リストアついて
インスタント リストアは Recovery Services コンテナーからの転送フェーズがございませんので、上記のグラフ結果よりも早い復元が期待できる機能でございます。

下記のように回復の種類に "スナップショット" が含まれる場合は自動的にインスタント リストアとなります。

![](https://user-images.githubusercontent.com/71251920/178863089-01be3556-bf72-472a-9e48-888f80dd7875.png)


・Azure Backup のインスタント リストア機能を使用してバックアップと復元のパフォーマンスを改善する
https://docs.microsoft.com/ja-jp/azure/backup/backup-instant-restore-capability



## <a id="2"></a> 2. データディスクの数とバックアップやリストアにかかる時間
また類似の質問として、Azure VM Backup において**同じデータ量であればディスクの数が多い方が早いか？または遅いか？**といった質問もいただくことがございますが、[1.](#1)と同様の理由から一概に**どちらの方が早くなるなどといったことはお伝えできません。**
しかしながら、他のユーザー様の影響を全く受けない環境である場合、ディスクが多い方がその管理オーバヘッドの分だけ時間がかかると考えられます。

### <a id="2-1"></a> 2.1 リストア検証
(検証内容と結果)
下記それぞれの内容で 同じVM のリストアを実施し、リストア時間の所要時間を比較いたしました。
>#1　アタッチしたディスク：256GiB  × 4 本、 所要時間： 13:43
>#2　アタッチしたディスク：1024GiB × 1 本、 所要時間： 12:10

その結果、上記の通りのディスクの本数が 4 本のものが 1 本のものに比べ、 1 分 33 秒 多く時間がかかったことが結果として得られました。


お客様のお役に立てれば幸いです。
本記事は以上です。